---
title: COM 411
template: "../resources/template.html"
output: 
  revealjs::revealjs_presentation:
    theme: white
    progress: true
    transition: convex
    self_contained: true
    css: ../../resources/custom_css.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = './')
source("resources/preamble.R")

library(igraph)
```

# Network Data and Network Types


## What is a social network?

> - Nodes
>	- Usually people
> - Edges / ties
>	- Relationships between them
>	  - Friendship
>	  - Hatred
>	  - Advice
>	  - Time spent together
>	  - Diseases transmitted

## Network Data

> - What are the three main ways of representing networks?

## Matrices

```{r, include = T}
sw = watts.strogatz.game(2, 4, 1, .2)
as_adjacency_matrix(sw)
```

## Edgelists

```{r, include = T}
as_edgelist(sw)

```

## Graphs/plots/sociograms

```{r, include = T}
plot(sw,
     vertex.label.cex = .5
     )
```

## Where does social network data come from?

>- Surveys
>- Observation
>- Trace data

# Network Types

## Ego networks

>- Typically created from surveys

```{r, include = T}
plot(make_ego_graph(sw, nodes = 1)[[1]])

```

## Extended ego networks

```{r, echo = F}
plot(
  make_ego_graph(sw, 
                 nodes = 1, 
                 order = 2)[[1]])

```

## Bipartite Networks

>- 20 random reddittors and their communities

<div class='fragment'>
```{r, echo = F, message=F, echo=F}
library(tidyverse)
r = read_csv('../../resources/one_k_redittors.csv')
r = r %>% filter(author %in% sample(unique(r$author), 50))
r = r %>% filter(! subreddit %in% r$author)
G = graph.data.frame(r, directed = T)
V(G)$type = TRUE
V(G)[name %in% r$subreddit]$type = FALSE

l = layout.bipartite(G, )
colors = c('steelblue', 'orange')
shapes = c('circle', 'square')
```
```{r, echo=F}

plot_graph = function(g){
  plot(g,
     layout = layout.fruchterman.reingold(g),
     #vertex.color = colors[V(g)$type + 1],
     #vertex.shape = shapes[V(g)$type + 1],
     vertex.size = 4,
     vertex.label.cex = .2
       )
}

G %>% induced_subgraph(unlist(sapply(1:20, subcomponent, graph = G, mode = 'out'))) %>%
  plot(
     layout = layout.bipartite(.),
     vertex.color = colors[V(.)$type + 1],
     vertex.shape = shapes[V(.)$type + 1],
     vertex.size = 4,
     vertex.label = ""
     #edge.width = log1p(E(G)$posts)
     )
```
</div>

## What does this data look like?

```{r}
head(r)
```

## Bipartite networks can be "projected"

>- People who post in the same communities


<div class='fragment'>
```{r, echo=F}
projections = bipartite_projection(G)
sr = projections[[1]]
people = projections[[2]]

people %>% delete.vertices(degree(.) < 1) %>%
  plot_graph()
```
</div>

## Communities with the same users

<div class='fragment'>
```{r, echo = F}
sr %>% delete.vertices(degree(.) < 1) %>%
  plot_graph()
```
</div>

## Nodes and edges can have attributes

```{r, echo = F}
V(sw)$gender = sample(c(1,2,3), 
                      length(V(sw)), 
                      replace = T)

colors <- c('green','orange','red')
V(sw)$color <- colors[as.integer(V(sw)$gender)]
plot(sw)
```

## Edge attributes

>- Usually this is weight

<div class='fragment'>
```{r, echo = F}
tmp = delete.edges(people, which(E(people)$weight < 2))
tmp %>%
  delete.vertices(degree(.) < 1) %>%
  plot(
    layout = layout_with_fr(.),
    vertex.size = 9,
    vertex.label.cex = .4,
    edge.width = E(.)$weight
  )
```
</div>

## What can we learn from networks?

> - Metrics about the network
>	- Density, clustering, etc.
> - Metrics about the nodes
>	- Power, influence, popularity
> - Look at how things change over time


# Tuesday Lecture

## Today's Dad Joke

Shout out to people wondering what the opposite of 'in' is.


## Housekeeping

> - Discussion questions
>	- Monday at noon

## Schedule

> - Housekeeping / Announcements (5-10)
> - Discussion and review (35-45)
> - Consolidation and Confusion (10-15)
> - Supplementary lectures
>	- Response to needs
>	- Discuss at end of class


## Review

> - How did installing R + RStudio go?
> - Homework review
>	- Encouragement to be prepared
>	- Time to identify confusion - it's OK to be confused!
> - Discussion questions review

## Consolidation

> - What were some of the key ideas?
> - What are you thinking differently about now?
> - What are remaining questions/confusions?
